<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Repos web application</title>
<link rel="shortcut icon" href="/favicon.ico">
<!-- the CSS must be placed after the head script so it is not updated according to theme settings -->
<link href="style/global.css" rel="stylesheet" type="text/css">
<link href="style/docs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="scripts/head.js"></script>
<style type="text/css">
body {
	min-width: 760px;
}
#banner {
	height:104px;
	margin: 0px;
	padding: 0px;
	background-image:url(style/logo/2005-05-09_19-24-22.jpg);
	background-position:right;
	background-repeat:no-repeat;
}
#releaseversion {
	font-weight: bold;
	color: #000000;
}
</style>
</head>
<body onLoad="">
<div id="contents">
<table width="760" align="center" class="columns" border="0" cellspacing="0">
  <tr>
  	<th id="banner" align="left" valign="middle" colspan="3">
		<img alt="repos.se" src="style/logo/repos4.png" width="288" height="72" border="0" hspace="16" vspace="16"/>
		<img alt="Versionshantering &aring;t folket" src="style/logo/bannertext.png" width="424" height="40" border="0" hspace="0" vspace="0" title="photo: Hj&auml;lmaren, Sweden (c) Staffan Olsson."/>
	</th>
  </tr>
  <tr align="center">
  	<td id="explain" colspan="3" style="border-left: 0px; border-right: 0px; padding:16px; ">
  	Repos version <span id="releaseversion" class="versiondisplay">$URL$</span>
  	</td>
  </tr>
  <tr>
	<th scope="col" align="left">Server status</th>
	<th scope="col" align="left">Reposiotory status</th>
	<th scope="col" align="left">Installed libraries</th>
  </tr>
  <tr valign="top">
    <td width="33%" style="border-left: 0px;">
<p id="serverprimary"></p>
<script type="text/javascript">
$.getJSON('view/service/?s=SERVER', function(json) {
	$('#serverprimary').append(
		json.primary ? 'This is a primary server. It should host the main repository and the backup files.'
		: 'This is a repos mirror. It should host a readonly copy of the repository.');
});
</script>
<p>Client address: <span id="clientaddress"></span></p>
<p>Local client? <span id="clientlocal"></span></p>
<p>Admin client? <span id="clientadmin"></span></p>
<script type="text/javascript">
$.getJSON('view/service/?s=CLIENT', function(json) {
	$('#clientaddress').append(json.address);
	$('#clientlocal').append(json.local ? 'yes' : 'no');
	$('#clientadmin').append(json.admin ? 'yes' : 'no');
});
</script>
<p>Licensed to: <span id="license"></span></p>
<script type="text/javascript">
$.getJSON('view/service/?s=LICENSE', function(json) {
	if (json.length == 0) {
		$('#license').append('No license information available.');
	} else {
		$('#license').append(json['Product-Name'] + ' registered to ' + json['Registered-To']);
	}
});
</script>
    </td>
    <td width="33%" id="repositorystatus">
<!-- if this page is visited a lot, this section should probably be removed -->
<script type="text/javascript">
$.getJSON('view/service/?s=STATUS', function(json) {
	var div = $('#repositorystatus');
	div.append('<p>'+json.repository+'</p>')
		.append('<p>at version: <span class="revision">'+json.headrev+'</span></p>');
	if (json.lastrev) {
		div.append('<p>Backup exists up to version: <span class="revision">'+json.lastrev+'</span></p>');
		if (json.hasgaps) {
			div.append('<p class="error">There are backup gaps, please notify an administrator.</p>');
		}
	} else {
		div.append('<p class="warning">No backup archives found.</p>');
	}
});
</script>
    </td>
    <td width="34%" style="border-right: 0px;" id="libstatus">
<!-- if this page is visited a lot, this section should probably be removed -->
<script type="text/javascript">
$.getJSON('lib/install.php', function(json) {
	var any = false;
	for (var id in json) {
		if (json[id].installed) {
			if (id=='smarty') any = true;
			$('#libstatus').append('<p>'+json[id].name+'</p>');
		}
	}
	if (!any) {
		$('#libstatus').append('<p>No 3rd party libraries installed. See <a href="lib/">lib/</a>.</p>');
	}
});
</script>
    </td>
  </tr>
  <tr><td colspan="3" align="center"><small>This application makes use of cookies. 
  See the Repos <a id="agreement" href="docs/agreement/" target="_blank">terms and conditions</a> before login.</small></td></tr>
  <tr>
  	<td colspan="3" align="center">
		<a id="serverroot" href="/" title="server root">startpage</a> &nbsp; 
		| &nbsp; <a id="login" href="/?login" title="Your account">log in</a> &nbsp;
		| &nbsp; <a id="lostpassword" href="account/reset/" title="Get temporary password">lost&nbsp;password?</a> &nbsp;
		| &nbsp; <a id="accountcreate" href="account/create/" title="Create new login">create&nbsp;account&nbsp;(admin)</a> &nbsp; 
		| &nbsp; <a id="reposadmin" href="admin/">admin&nbsp;page</a> &nbsp;
		| &nbsp; <a href="scripts/styleswitch/">select&nbsp;theme</a> &nbsp; 
		| &nbsp; <a href="docs/">online&nbsp;documentation</a>
  </tr>
</table>
</div>
<!--
<div id="news">
<iframe src="/repos/view/service/?url=https://www.repos.se/sweden/staffan/messages.xml" id="feed" name="feed" style="display:none" frameborder="0" scrolling="auto"></iframe>
</div>
-->
<div id="releaseversion" class="versiondisplay" style="display:none">repos.se version $URL$ $Rev$</div>
</body>
</html>
