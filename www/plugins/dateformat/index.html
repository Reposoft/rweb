<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>repos: dateformat plugin test page</title>
<!-- plugins -->
<script type="text/javascript" src="../../scripts/lib/jquery/jquery.js"></script>
<script type="text/javascript" src="dateformat.js"></script>
<!-- for unit testing -->
<script type="text/javascript" src="../../scripts/unittest/testwalk.js"></script>
</head>

<body>
<h1>Repos dateformat plugin</h1>
<p>Dynamically change datetime fields to the local time zone and format</p>
<h2>examples</h2>
<h3><code>p.datetime: 2006-09-07T16:00:00.123456Z</code></h3>
<p id="d1" class="datetime">2006-09-07T16:00:00.123456Z</p>
<h3><code>span.datetime: 2006-09-06T20:30:59.000Z</code></h3>
<span id="d2" class="datetime">2006-09-06T20:30:59.000Z</span>
<h3><code>span.datetime: 2006-12-06T20:30:59+01:00</code></h3>
<span id="d3" class="datetime">2006-12-06T20:30:59+01:00</span>
<h3><code>span.datetime: 2006-12-06T20:30:59-01:00</code></h3>
<span id="d4" class="datetime">2006-12-06T20:30:59-01:00</span>
<h3><code>span.datetime: 2006-06-06T20:30:59+02:00</code></h3>
<span id="d5" class="datetime">2006-06-06T20:30:59+02:00</span>
<h2>unit tests</h2>
<script type="text/javascript">
	
function testFormat() {
	var d = "2006-09-07T12:00:00.000Z";
	var f = $.fn.dateformat.format(d);
	assert("den 7 september 2006 14:00:00", f, "Should make an iso date with no milliseconds.");
}

function testFormatElement() {
	var e = document.createElement('span');
	e.innerHTML = "2006-09-07T12:00:00.000Z";
	$.fn.dateformat.formatElement(e);
	assert("den 7 september 2006 14:00:00", e.innerHTML, "Should format the date of the element that has not been added to the DOM");
}

function testFormatAll() {
	// The plugin has already executed, through onload
	var formatted1 = $('#d1').text();
	var formatted2 = $('#d2').text();
	assert($.fn.dateformat.format('2006-09-07T16:00:00.123456Z'), formatted1, "Should format all 'datetime' texts on load");
	assert($.fn.dateformat.format('2006-09-06T20:30:59.000Z'), formatted2, "Should format all 'datetime' texts on load");
}

function testFormatEmpty() {
	var e = document.createElement('span');
	e.innerHTML = "";
	$.fn.dateformat.formatElement(e);
	assert("" == e.innerHTML);
}

function testFormatTwice() {
	var e = document.createElement('span');
	var t = "2006-09-07T12:00:00.000Z";
	e.innerHTML = t;
	$.fn.dateformat.formatElement(e);
	// dateformat should set the class 'formatted' when successful
	// does not work in IE // assert('formatted', e.getAttribute('class'));
	assert($(e).is('.formatted'));
	// now try to format the same tag again
	var d = e.innerHTML;
	assert(t != d);
	$.fn.dateformat.formatElement(e);	
	assert(e.innerHTML, d);
}

</script>

</body>
</html>
