<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Upload to repos</title>
<script type="text/javascript">
function autoFillFilename(filename) {
	if (!filename) filename = 'newtext';
	if (!/\.[\w\d]{1,4}$/.test(filename)) {
		var type = document.getElementsByName('type')[0].value;
		document.getElementsByName('name')[0].value = filename+'.'+type;	
	}
}
</script>
<!--{$head}-->
</head>

<body>
<div id="workspace">
<div id="commandbar">
<a id="repository" class="command" href="{=$repository|urlEncodeNames}">return to repository</a>
<!--{if $file}-->
<a id="view" class="command" target="_blank" href="../../open/file/?target={=$target}&rev={=$file,revision}">view current version</a>
<!--{else}-->

<!--{/if}-->
</div>
<div id="contents">

<a name="textform"></a>
<form id="formEdit" action="../upload/" method="post" name="formUpload">
<fieldset>
	<!--{if $file}-->
	<legend>Edit <a class="file" href="{=$file,url}">{=$target}</a> {=$file,revision} with type {=$file,type}</legend>
	<!--{else}-->
	<legend>Create new file in {=$target}</legend>
	<!--{/if}-->
  <input type="hidden" name="target" value="{=$target}"/>
  <input type="text" name="type" value="{=$type}" style="display:none"/>
	<!--{if $file}-->
	<input type="hidden" name="fromrev" value="{=$file,revision}"/>
	 {=*
	 	Textarea must be on one line so it does not insert spaces.
	 	The 'type' field is the type of contents (which decides how the text should be formatted).
	 	The class of the text area is the filename extension.
	 	Recommended filename extension for new files is =type.
	 	*}
    <textarea name="usertext" id="usertext" class="{=$file,extension}" cols="82" rows="20" tabindex="1">{=$file->sendInlineHtml()}</textarea>
	<!--{else}-->
	<textarea name="usertext" id="usertext" class="{=$type}" cols="82" rows="20" tabindex="1"></textarea>
	<!--{/if}-->
    <label for="userfile"></label>
  <p>
    <label for="currentname">name in repository</label>
	<!--{if $file}-->
    <input type="text" id="currentname" name="currentname" value="{=$target|basename}" disabled="disabled" size="40" />
	<!--{else}-->
	<input type="text" id="name" name="name" size="40" class="required" tabindex="2" onblur="autoFillFilename(value)"/>
	<input type="hidden" id="create" name="create" value="yes"/>
	<!--{/if}-->
  </p>
  <p>
    <label for="message">log message</label>
    <textarea id="message" name="message" cols="40" rows="2" tabindex="3"></textarea>
  </p>
  <p>
    <label for="submit"></label>
    <input id="submit" type="submit" name="Submit" value="Save" tabindex="4" />
    <input type="reset" value="Reset to original contents"/>
    <input type="button" value="Clear contents" onclick="document.forms[0]['usertext'].value=''"/>
  </p>
</fieldset>
</form>
</div>
</div>
</body>
</html>
