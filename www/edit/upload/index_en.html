<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Upload to repos</title>
<script type="text/javascript">
function autoFillFilename(path) {
<!--{if not $isfile}-->
	var pos = Math.max(path.lastIndexOf('/'), path.lastIndexOf('\\'));
	if (pos > 0) {
		var filename = path.substring(pos + 1);
		document.getElementsByName('name')[0].value = filename;
	}
<!--{/if}-->
}
</script>
<!--{$head}-->
</head>

<body>
<div id="workspace">
<div id="commandbar">
<a id="repository" class="command" href="{=$repository|urlEncodeNames}">return to repository</a>
</div>
<div id="contents">
<h1>Upload file</h1>
<!--{if $isfile}-->
<p>As a new version of file <span class="path">{=$target}</span>. <a class="action" target="_blank" href="../open/?target={=$target}">open current version</a></p>
<div class="details" title="{=$target}" style="display: none">
Current revision: <span class="revision"></span><br />
Last modified <span class="datetime"></span> by <span class="username"></span><br />
Filesize: <span class="filesize"></span><br />
</div>
<div class="warning">
<p>File upload is a convenient feature, but not a real versioning operation.
It <em>will</em> overwrite the existing file,
unlike a versioning commit that would check for conflicts first.
Please check existing contents before uploading,
to make sure that your local changes are based on the newest version of the shared file.
</p>
</div>
<!--{else}-->
<p>As a new file in folder {=$target}</p>
<!--{/if}-->
<form action="./" method="post" enctype="multipart/form-data" name="formUpload" id="formUpload">
<fieldset>
  <legend>Upload to repos</legend>
  <input type="hidden" name="target" value="{=$target}"/>
  <p>
    <label for="userfile">local file</label>
	<input type="hidden" name="MAX_FILE_SIZE" value="{=$maxfilesize}" />
    <input type="file" name="userfile" size="40" onchange="autoFillFilename(value)" class="required" tabindex="1" />
    <span class="note">Maximum file size 10MB</span>
  </p>
  <p>
    <label for="currentname">name in repository</label>
	 <!--{if $isfile}-->
    <input type="text" id="currentname" name="currentname" value="{=$target|basename}" disabled="disabled" size="40" />
    <!--{else}-->
	 <input type="text" id="name" name="name" size="40" class="required" tabindex="2" />
	 <input type="hidden" id="create" name="create" value="yes"/>   
    <!--{/if}-->
  </p>
  <!--{if $isfile}-->
  <p title="the version of the file when it was downloaded">
    <label for="fromrev">based on version</label>
    {=foreach from=$log key=r item=e}
    	<input type="radio" name="fromrev" value="{=$r}" /><span class="revision">{=$r}</span> 
    	<span class="username">{=$e.user}</span> <span class="datetime">{=$e.date}T{=$e.time}{=$e.z}</span><br />
    {=/foreach}
    <!-- <input type="text" id="fromrev" name="fromrev" maxlength="10" size="15"/> -->
  </p>
  {=if $file,isLockedByThisUser}
  <p>
  	 <label for="unlock">unlock at commit</label>
  	 <input type="checkbox" id="unlock" name="unlock"/>
  </p>
  {=/if}
  <!--{else}-->
  <p>
  	 <label for="needslock">should be locked before edit</label>
  	 <input type="checkbox" id="needslock" name="needslock"/>
  </p>
  <!--{/if}-->
  <p>
    <label for="message">history text</label>
    <textarea id="message" name="message" cols="40" rows="2" tabindex="3"></textarea>
  </p>
  <p>
    <label for="submit"></label>
    <input id="submit" type="submit" name="Submit" value="Upload" tabindex="4" />
  </p>
</fieldset>
</form>
</div>
</div>
</body>
</html>
