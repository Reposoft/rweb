<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>repos: Edit {=$file,filename} {=$file,revision}</title>
<!--{$head}-->
</head>
<body>
<div id="commandbar">
<a id="repository" href="{=$file,folderUrl}">return to repository</a>
<a id="view" href="../open/?target={=$target}&rev={=$rev}">view</a>
</div>
<div id="intro">
<h1><a class="file" href="{=$file,url}">{=$file,filename}</a> <span class="revision">{=$file,revision}</span></h1>
<p>If you only need to read the file, not edit it, go to <a href="../open/?target={=$target}&rev={=$rev}">view</a>.</p> 
<!--{if not $file,isLatestRevision}-->
<p>This is an old version of the file. It can not be edited.
You may <a href="../edit/?target={=$target}">edit current version of {=$file,filename}</a>.</p>
<!--{elseif not $file,isWritable}-->
<p>You have only read access to this file. Contact the user administrator to get write access.</p>
<!--{elseif $file,isLockedBySomeoneElse}-->
<p>You can not edit the file, because it is currently <strong>locked</strong> by 
<span class="username">{=$file,lockOwner}</span> {=if $file,lockComment} with message &quot;<span class="message">{=$file,lockComment}</span>&quot;{=/if}.
The file will be unlocked when a new version is committed.
</p>
<!--{else}-->
<p>You may edit this file, to produce a new version with higher number.
Using the current version number <span class="revision">{=$file,revision}</span>, 
you can always refer to the file as it is now.</p>
</div>
<div class="column" style="width: 60%">
<div id="activities" class="section">
<h2>Edit</h2>
{=if $file,isLockedByThisUser}
<p>The file is <strong>locked</strong> by you. We recommend you <a href="upload/?target={=$target}">Upload new version</a>.</p>
{=elseif $file,isPlaintext and $file,size lt 102400}
<p>This is a text file that's not too big. We recommend you 
<a href="text/?target={=$target}">Edit in Repos</a>.</p>
{=elseif $file,isPlaintext}
<p>This is a text file. There is no need to lock it.
<a href="../open/download/?target={=$target}&rev={=$rev}">Download</a>,
edit on your computer, then <a href="upload/?target={=$target}">upload new version</a>.</p>
{=else}
<p>This is a binary or unknown fileformat. We recommend you Download and lock.</p>
{=/if}

{=if not $file,isLockedByThisUser}
<h3><a id="download_upload" href="upload/?target={=$target}&rev={=$rev}&download">Download, modify, upload</a></h3>
<p>
<span class="explain" title="files stored as lines of text that are human-readable in any text editor, like Notepad">Text files</span> 
can be edited by many users at the same time, and when you upload the new version
the system will identify which lines you changed, 
and <span class="explain" title="combine two different changes of the same file into a new version of the file">merge</span>
those changes with the existing contents to create a new version.
</p>
<h3><a id="download_lock" href="lock/?target={=$target}&download">Download with lock</a></h3>
<p>
For <span class="explain" title="files stored in a non-text format created and read by a specific application">binary</span>
files, version control is not as efficient as with text files.
The difference between two versions can not be expressed as a
<span class="explain" title="the difference between two versions, expressed as only the lines that have changed">diff</span>,
so each change must be based on the previous version.
This means that only one user at a time can work with the file.
</p>
{=/if}
<h3><a id="upload" href="upload/?target={=$target}">Upload new version</a></h3>
<p>
If you have already downloaded and edited the file, upload your changes to create a new verison.
</p>
<h3><a id="editfile" href="text/?target={=$target}">Edit in Repos</a></h3>
<p>
Plaintext file formats can be conveniently edited in your browser.
No locking is needed, and when you save it creates a new version of the file.
</p>
<h3><a id="propedit" href="propedit/?target={=$target}">Edit properties</a></h3>
<p>
Edit versioned metadata on this item.
</p>

<!--{if not $file,isBranch}-->
{=* personal branches not in 1.1
<h3>
<!-- temporary solution, requires /branches folder in root, which is not fair to the other repository layouts -->
<a id="branch" href="copy/?target={=$target}&oldname={=$oldname}&tofolder=%2Fbranches%2F&newname={=$file,revision}-{=$file,authenticatedUser}-{=$file,filename}&move=0&message={=$message}&submit=Copy">
Create personal branch</a></h3>
<p>A personal branch is a copy of this file, where you can do major modifications
without disturbing anyone else. If is useful if you need several days for your changes.
Your personal, temporary, copy would be: 
<span class="path">/branches/{=$file,revision}-{=$file,authenticatedUser}-{=$file,filename}</span>
You will get a link to the branch, and from there you can access the "merge" functionality.</p>
*}
<!--{/if}-->

{=if not $file,isLocked}
<h3><a id="lock" href="lock/?target={=$target}">Lock file</a></h3>
<p>You can always lock a file to make it read-only for everyone else.</p>
{=elseif $file,isLockedByThisUser}
<h3><a id="unlock" href="unlock/?target={=$target}">Unlock file</a></h3>
<p>This file is locked by you. If you are not working with it,
you can unlock it so that others are able to edit it.</p>
{=/if}

<h3><a id="useurl" href="#urlcopy" onblur="document.getElementById('urlcopy').select();">Use the URL</a></h3>
<!--{if $file,isLatestRevision}-->
<p>Many modern programs can use URLs to open files directly from the server.</p>
<p>Office documents can usually be edited directly.
Paste the URL into the "open" dialog in word or excel, 
and when you save it will automatically be committed to repository.</p>
<!--{else}-->
This is not the latest version of the file, so you can not use the URL to access it.
You need to use a version control client like Repos.
<!--{/if}-->

<!--{/if}-->
</div>
</div>
<div class="column" style="width: 40%">
<div id="filedetails" class="section">
<h2>File details</h2>
<p>Version number: <span class="revision">{=$file,revision}</span></p>
<p>Last edited by: <span class="username">{=$file,author}</span></p>
<p>Last edited at: <span class="datetime">{=$file,date}</span></p>
<p>File size: <span class="filesize">{=$file,size|formatSize}</span></p>
<p>Content type: <span>{=$file,type}</span></p>
<!--{if $file,isLocked}-->
<p class="lock">Locked by 
<span class="username">{=$file,lockOwner}</span> <span class="datetime">{=$file,lockCreated}</span>
{=if $file,lockComment}<br /> <span class="message">{=$file,lockComment}</span>{=/if}
</p>
<!--{/if}-->
</div>
</div>
<div id="footer">
<input id="urlcopy" title="Ctrl+C to copy the URL to clipboard" name="url" type="text" readonly="readonly" value="{=$file,url}" onclick="this.select();"/>
</div>
</body>
</html>
