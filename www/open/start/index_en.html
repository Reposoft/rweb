<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>repos: repository access</title>
<!--{$head}-->
</head>

<body>

<div id="commandbar">
<div class="right">
<a href="/?logout" id="logout">logout</a>
<img src="{=$webapp}style/logo/repos1.png" border="0" width="72" height="18" alt="repos.se" title="repos.se content management"/>
</div>
<a id="parent" href="../../">repos</a>
</div>

<div id="intro">
<h1><img src="{=$webapp}style/logo/repos2.png" border="0" align="absmiddle" width="144" height="36" alt="Repos "/> startpage</h1>
<p>You are logged in with username <em>{=$userfullname}</em>.
This startpage lists the projects that you have access to,
and the tools in each project.</p>
</div>

<div class="column" style="width: 50%">
<!--{foreach from=$entrypoints item=entry name=project}-->
<!--{assign var='projectname' value=$entry->getDisplayname()}-->
<!--{* tools array should be read only once because it is a service call *}-->
<!--{assign var='projecttools' value=$entry->getTools()}-->
<div class="section" id="p:{=$projectname|getFileId}">
<h2>
<!--{* todo: make a smarter link, trunk/ if existing, project root if no trunk *}-->
<span class="{=if $projectname eq $userfullname}username{=else}projectname{=/if}">{=$projectname}</span>
{=if !$entry->getPath()}&nbsp;root{=/if}
<!--{* 
<a class="folder {=if $entry->isReadOnly()}readonly{=/if}" href="{=$webapp}open/project/?target={=$entry->getPath()}/">{=$projectname}</a>
 *}-->
</h2>
<ul class="index">
	<!--{* bug with generated 'foreach a as b => c' in zendguard4+php5.2, derive key *}-->
	<!--{assign var='projecttoolids' value=$projecttools|@array_keys}-->	
	<!--{foreach from=$projecttoolids item=toolid}-->
	<!--{assign var='toolpath' value=$projecttools.$toolid}-->
	<li class="n{=cycle values=0,1,2,3}">
	{=* special cases not handled by open *}
	{=if $toolid eq 'news'}{=assign var='toolpath' value=`$toolpath`news.xml}{=/if}
	{=*{=if $toolid eq calendar}{=assign var='toolpath' value=`$toolpath``$projectname`.ics}{=/if}*}
	<a id="{=$toolid}:{=$projectname}" class="tool {=$toolid}" href="{=$webapp}open/?target={=$entry->getPath()}/{=$toolpath}">
	<img border="0" src="{=$webapp}style/tools/{=$toolid}.png" hspace="10"/>{=$toolid}</a>
	</li>
	<!--{/foreach}-->
</ul>
</div>
{=if $smarty.foreach.project.iteration + $smarty.foreach.project.iteration eq $smarty.foreach.project.total
or $smarty.foreach.project.iteration + $smarty.foreach.project.iteration - 1 eq $smarty.foreach.project.total}
</div>
<div class="column" style="width: 49%"><!--{* IE6 does not accept 50% for this column *}-->
{=/if}
<!--{/foreach}-->
</div>

<div id="footer">
<span id="releaseversion" class="versiondisplay">Repos @Dev@</span>
<span class="legal">Repos is a web platform for version control with <a target="_blank" href="http://subversion.tigris.org/">Subversion</a>, see <a id="agreement" href="{=$webapp}docs/agreement/" target="_blank">terms and conditions</a></span>
</div>

</body>
</html>
