<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>repos.se dateformat plugin test page</title>

<link href="../../../style/global.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../lib/scriptaculous/prototype.js"></script>
<script type="text/javascript" src="dateformat.js"></script>
<script type="text/javascript" src="../../lib/scriptaculous/unittest.js"></script>
</head>


<body>
<p id="d1" class="datetime">2006-09-07T16:00:00.123456Z</p>
<span id="d2" class="datetime">2006-09-06T20:30:59.000Z</span>

<div id="testlog"></div>

<script type="text/javascript">
new Test.Unit.Runner({
	
	dateformat: null,

	setup: function() { with(this) {
		this.dateformat = new Dateformat();
	}},

	testGetElements: function() { with(this) {
		var n = dateformat.getElements('datetime');
		assertEqual(2, n.length, "Should find two tags with classname 'datetime'");
		assertEqual($('d1'), n[0], "Should find the first element with class datetime.");
		assertEqual($('d2'), n[1], "Should find the second element with class datetime.");
	}},
	
	testFormat: function() { with(this) {
		var d = "2006-09-07T12:00:00.000Z";
		var f = dateformat.format(d);
		assertEqual("2006-09-07 12:00:00", f, "Should make an iso date with no milliseconds.");
	}},
	
	testFormatElement: function() { with(this) {
		var e = document.createElement('span');
		e.innerHTML = "2006-09-07T12:00:00.000Z";
		dateformat.formatElement(e);
		assertEqual("2006-09-07 12:00:00", e.innerHTML, "Should format the date of the element that has not been added to the DOM");
	}},
	
	testFormatAll: function() { with(this) {
		// The plugin has already executed, through onload
		var formatted1 = $('d1').innerHTML;
		var formatted2 = $('d2').innerHTML;
		assertEqual(dateformat.format('2006-09-07T16:00:00.123456Z'), formatted1, "Should format all 'datetime' texts on load");
		assertEqual(dateformat.format('2006-09-06T20:30:59.000Z'), formatted2, "Should format all 'datetime' texts on load");
	}},

	teardown: function() { with(this) {}}
}, { });
</script>

</body>
</html>
