<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Repos Quay demo and test page</title>

<!-- all this should be in a single repos-quay.js file one day, to include from any page -->
<script type="text/javascript" src="scripts/autosuggest.js" defer="true"></script>
<script type="text/javascript">

/*
	This sourcecode is copyrighted... och nåt annat bra att säga...
*/
	document.write('<link href="css/quicksilver.css" rel="stylesheet" type="text/css" />');

	/*global vars*/
	var emod; /*the event model*/
	var altDown = false;
	var linkCache = new Array();
	var Q_KEY = 81;

	function document_onKeyDown(){
		var e = window.event;
		altDown = (e.altKey) ? true : false;
		if(e.keyCode == 81 && altDown){
			showQuayWindow();
		}
		return false;
	}
	
	function linkObject(anchorNode){
		if (anchorNode.childNodes[0] instanceof HTMLImageElement) {
			var text = anchorNode.childNodes[0].title;
		} else {
			// text node
			var text = anchorNode.childNodes[0].data;
		}
		this.text = text.toString();
		this.url = anchorNode.href.toString();
	}
	
	function getQuayWindow(){
		var qsWin = document.getElementById("quay");
		
/*		if(!qsWin){
			var txtQSSearch = document.createElement("input");
			txtQSSearch.id = 'txtQuickSilverSearch';
			txtQSSearch.type = 'text';
			qsWin = document.createElement("div");
			qsWin.className = "qsWindow";
			qsWin.zIndex = 32767;
			qsWin.id = 'qsWindow';
			qsWin.appendChild(txtQSSearch);
			document.body.appendChild(qsWin);
			qsWin = document.getElementById("qsWindow");
		}
		qsWin.prototype.show = function(){
			document.getElementById("autosuggest").style.display = 'block';
		}
		
		qsWin.prototype.hide = function (){
			document.getElementById("autosuggest").style.display = 'none';
		}*/
		return qsWin;
		
/*		function show(){
			document.getElementById("qsWindow").style.display = 'block';
		}
		
		function hide(){
			document.getElementById("qsWindow").style.display = 'none';
		}*/
	}
	
	function getQuayInputBox() {
		return document.getElementById("txtQuaySearch");
	}
		
	function indexLinks(s){
		var as = document.body.getElementsByTagName("a");
		for(ix in as){
			if(as[ix].childNodes){
				linkCache.push(new linkObject(as[ix]));
			}
		}
	}
	
	function document_onLoad() {
		// run the indexing for autosuggest		  
		indexLinks();
		// make sure the Quay window is closed
		hideQuay();
	}
	
	function document_onUnload() {
		hideQuay();
	}
	
	function showQuay() {
		var qsWin = null;
//		var e = window.event;
//		altDown = (e.altKey) ? true : false;
//		if(e.keyCode == 81 && altDown){
			qsWin = getQuayWindow();
			qsWin.style.display = 'block';		
//			qsWin.show;
//		}
		getQuayInputBox().focus();
	}
	
	function hideQuay(){
		qsWin = getQuayWindow();
		qsWin.style.display = 'none';
	}
	
// Keyboard events disbled. Using only Firefox accesskeys for now.
//	document.onkeydown = document_onKeyDown;
	
</script>
<style type="text/css">
/* should be in the css file included from the javascript */
.top_bar_center_style {
	background-image: url(pics/top_bar_center_part.gif);
	background-repeat: repeat-x;
}
.quicksilver_window_style {
/*	border: 1px solid #7f9db9;*/
	border-left: 1px solid #c6c7c6;
	border-bottom: 1px solid #c6c7c6;
	border-right: 1px solid #c6c7c6;
}
.txt_quicksilver_input {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
	font-weight: bold;
	color: #66667e;
	text-decoration: none;
	border: 1px solid #66667e;
	width: 100%;
}
.quicksilver_window_mainarea {
	background-color: #e0dfe3;
}
.quicksilver_window_header {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
	font-weight: bold;
	color: #000000;
	text-decoration: none;
}

/* test page font */
body {
	margin-left: 100px;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 0.7em;
}
</style>

</head>
<body onload="document_onLoad();" onunload="document_onUnload();">
<!-- all HTML needed for repos-quay. Remember to include the js-file -->
<a id="quayIcon" title="Go Alt+Q for Quay" accesskey="Q" href="#" onclick="javascript:showQuay()"><img src="images/q1.png" width="19" height="18" border="0" alt="Q"/></a>
<!-- the box that will show matching links, printed by the javascript if supported by autosuggest.js -->
<div id="autosuggest" style="z-index:65001;"><ul></ul></div>
<!-- end repos-quay html -->
<h1>Repos Quay demo</h1>
<p><a href="clicked.html?i=up" title="Parent directory">..</a></p>
<p><a href="clicked.html?i=upup" title="Parent parent">../../</a></p>
<p><a href="clicked.html?i=up2">/up</a></p>
<p><a href="clicked.html?i=docs">docs/</a></p>
<p><a href="clicked.html?i=sources">sources</a></p>
<p><a href="clicked.html?i=.project">.project</a></p>
<p><a href="clicked.html?i=document.html">document.html</a></p>
<p><a href="clicked.html?i=s.doc">s.doc</a></p>
<p><a href="clicked.html?i=s%20m.doc">s m.doc</a></p>
<p><a href="clicked.html?i=samename.txt(1)">samename.txt</a></p>
<p><a href="clicked.html?i=samename.txt(2)">samename.txt</a></p>
<p><a href="clicked.html?i=sameurl.txt">sameURL.txt(1)</a></p>
<p><a href="clicked.html?i=sameurl.txt">sameURL.txt(2)</a></p>
<p><a href="clicked.html?i=samenameandurl">samenameandurl</a></p>
<p><a href="clicked.html?i=samenameandurl">samenameandurl</a></p>
<p><a href="clicked.html?i=auml">&auml;uml</a></p>
<p><small>-- <a href="selenium/TestRunner.html">run Quay tests</a> --</small></p>
<!-- what's this doing here? is it used by the autosuggest.js script? -->
<div id="debugger"></div>



<!-- the Quay popup, should be written by the script if supported by autosuggest.js -->
	<div id="quay" style="z-index:65000; position:absolute; top:200px; left:200px; display:none;">
	<!-- using onkeypress="return event.keyCode!=13" to disable browser's form handling on enter key -->
		<table width="300" border="0" cellpadding="0" cellspacing="0" class="quicksilver_window_style">
			<tr>
				<td>
					<table width="300" height="26" class="top_bar_center_style" border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td class="quicksilver_window_header">&nbsp;.: <a href="about.html">Repos Quay v.1.0</a> :.</td>
							<td width="21"><a id="quayCloseIcon" href="javascript:hideQuay();"><img src="pics/close_corner_button_normal.gif" border="0" /></a></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td class="quicksilver_window_mainarea" style="padding:10px;"><input id="txtQuaySearch" name="textfield" type="text" class="txt_quicksilver_input" /></td>
			</tr>
		</table>
		<script language="Javascript">
			new AutoSuggest(getQuayInputBox(), linkCache);
		</script>
	</div>
</body>
</html>


