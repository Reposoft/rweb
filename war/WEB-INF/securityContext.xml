<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
	
	<!-- repos code -->
	<bean id="authenticationManager" class="se.optime.repos.user.BasicAuthenticationManager">
	</bean>

	<!-- processing -->
	<bean id="securityEnforcementFilter" class="net.sf.acegisecurity.intercept.web.SecurityEnforcementFilter">
	  <property name="filterSecurityInterceptor"><ref bean="filterInvocationInterceptor"/></property>
	  <property name="authenticationEntryPoint"><ref bean="authenticationEntryPoint"/></property>
	</bean>
	
	<bean id="basicProcessingFilter" class="net.sf.acegisecurity.ui.basicauth.BasicProcessingFilter">
	  <property name="authenticationManager"><ref bean="authenticationManager"/></property>
	  <property name="authenticationEntryPoint"><ref bean="authenticationEntryPoint"/></property>
	</bean>
	
	<bean id="authenticationEntryPoint" class="net.sf.acegisecurity.ui.basicauth.BasicProcessingFilterEntryPoint">
	  <property name="realmName"><value>${repo_name}</value></property>
	</bean>
	
	<bean id="autoIntegrationFilter" class="net.sf.acegisecurity.ui.AutoIntegrationFilter" />
	
	<bean id="filterInvocationInterceptor" class="net.sf.acegisecurity.intercept.web.FilterSecurityInterceptor">
	  <property name="authenticationManager"><ref bean="authenticationManager"/></property>
	  <property name="accessDecisionManager"><ref bean="accessDecisionManager"/></property>
	  <!-- <property name="runAsManager"><ref bean="runAsManager"/></property> -->
	  <property name="objectDefinitionSource">
	    <value>
	      CONVERT_URL_TO_LOWERCASE_BEFORE_COMPARISON
	      \A/.*\Z=ANY_AUTHENTICATED_USER
	    </value>
	  </property>
	</bean>
	
	<bean id="accessDecisionManager" class="net.sf.acegisecurity.vote.AffirmativeBased">
   		<property name="allowIfAllAbstainDecisions"><value>false</value></property>
		<property name="decisionVoters">
		  <list>
		    <!-- <ref local="roleVoter"/> -->
		    <ref local="allowAll"/>
		  </list>
		</property>
	</bean>
	
	<!-- <bean id="roleVoter" class="net.sf.acegisecurity.vote.RoleVoter"/> -->
	<bean id="allowAll" class="se.optime.repos.user.AccessDecisionVoterAllowAll"/>
	
	<!-- debug -->
	<bean id="loggerListener" class="net.sf.acegisecurity.providers.dao.event.LoggerListener"/>
	
</beans>
