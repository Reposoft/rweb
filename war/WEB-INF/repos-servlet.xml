<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
  - Views and controllers
  -->
<beans>

	<!-- =========== views =========== -->

	<!-- =========== resolvers =========== -->
	
	<!-- internal url, last in resolver chain -->
	<bean id="viewResolver" 
	      class="org.springframework.web.servlet.view.InternalResourceViewResolver">
	    <property name="prefix"><value>/WEB-INF/jsp/</value></property>
	    <property name="suffix"><value>.jsp</value></property>
	    <property name="viewClass"><value>org.springframework.web.servlet.view.JstlView</value></property>
	</bean>
	
	<!-- ======== controllers ======== -->
	<bean id="pathValidator" class="se.optime.repos.webdav.RepositoryPathValidator">
    </bean>
	
	<bean id="saveController" class="se.optime.repos.webdav.action.SaveFileController">
	    <property name="commandClass"><value>se.optime.repos.webdav.action.RepositoryUpdate</value></property>
	    <property name="validator"><ref local="pathValidator"/></property>	    
	</bean>
	
	<bean id="documentController" class="se.optime.repos.document.DocumentController">
	    <property name="commandClass"><value>se.optime.repos.webdav.RepositoryResource</value></property>
	    <property name="validator"><ref local="pathValidator"/></property>
	</bean>

	<!-- ========= mappings ========== -->
    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <!-- shared actions -->
                <prop key="/save.jwa">saveController</prop>
                <!-- filetypes -->
                <prop key="/**/*.doc.jwa">documentController</prop>
                <prop key="/**/*.html.jwa">documentController</prop>
             </props>
        </property>
    </bean>

</beans>
